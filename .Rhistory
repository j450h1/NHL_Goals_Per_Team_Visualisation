theme_bw()
finaldf$COLORS <- "ghostwhite"
finaldf$TEAM == VAN
finaldf$TEAM == "VAN"
finaldf
finaldf[finaldf$TEAM == "VAN",3]
finaldf[finaldf$TEAM == "VAN",3] <- "blue"
finaldf[finaldf$TEAM == "VAN",3]
finaldf[finaldf$TEAM == "VAN",3] <- "orange"
finaldf$COLORS
finaldf[finaldf$TEAM == "VAN",3] <- "blue"
finaldf[finaldf$TEAM == "CGY",3] <- "orange"
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity",color = "black") +
scale_fill_manual(values = COLORS))
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity",color = "black") +
scale_fill_manual(values = finaldf$COLORS))
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity",color = "black") +
scale_fill_manual(values = finaldf$COLORS) +
coord_flip() +
theme_bw()
library(ggplot2)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity",color = "black") +
scale_fill_manual(values = COLORS) +
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
scale_fill_manual(values = finaldf$COLORS) +
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
scale_fill_manual(fill = finaldf$COLORS) +
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
scale_colour_manual(values = finaldf$COLORS) +
coord_flip() +
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
scale_colour_manual(values = finaldf$COLORS) +
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
scale_colour_manual(values = finaldf$COLORS) +
coord_flip() +
theme_bw()
finaldf$COLORS
class(finaldf$COLORS)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
coord_flip() +
theme_bw() +
scale_colour_manual(values = finaldf$COLORS)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
coord_flip() +
scale_colour_manual(values = finaldf$COLORS)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
coord_flip() +
scale_fill_manual(values = finaldf$COLORS)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS) +
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
scale_x_discrete(limits=c(100,200))
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
scale_x_discrete(breaks=100:250)
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
theme_bw() +
xlim(100,250)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
theme_bw() +
xlim(100.0,250.0)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
theme_bw() +
scale_x_continuous(limits=c(100, 250))
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
coord_flip() +
theme_bw() +
scale_y_continuous(limits=c(100, 250))
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
scale_y_continuous(limits=c(100, 250)) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS,label=TOTAL_GOALS),vjust=0) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS,label=TOTAL_GOALS),vjust=0) +
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS,label=TOTAL_GOALS),vjust=0) +
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS,label=TOTAL_GOALS),vjust=0)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS,label=TOTAL_GOALS),vjust=0)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=TOTAL_GOALS),vjust=0)
finaldf$labels <- ""
which([finaldf$TEAM == "VAN",4])
which(finaldf$TEAM == "VAN")
finaldf[finaldf$TEAM == "VAN",4] <- df[which(finaldf$TEAM == "VAN"),2] #2nd col is TOTAL_GOALS
finaldf[finaldf$TEAM == "CGY",4] <- df[which(finaldf$TEAM == "CGY"),2] #2nd col is TOTAL_GOALS
finaldf$labels
which(finaldf$TEAM == "CGY"),2
which(finaldf$TEAM == "CGY")
finaldf[finaldf$TEAM == "CGY",4]
finaldf$TEAM == "CGY"
df[which(finaldf$TEAM == "CGY"),2]
View(finaldf)
finaldf[finaldf$TEAM == "VAN",4] <- finaldf[which(finaldf$TEAM == "VAN"),2] #2nd col is TOTAL_GOALS
finaldf[finaldf$TEAM == "CGY",4] <- finaldf[which(finaldf$TEAM == "CGY"),2] #2nd col is TOTAL_GOALS
finaldf$labels
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
ylim(100,200)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
ylim(100,250)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=1:250)
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(0, 250, by=5))
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(0, 250, by=10))
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(0, 250, by=10)) +
coord_flip()
debugSource('~/NHL_Goals_Per_Team_Visualisation/NHL_munging.R', echo=TRUE)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(0, 250, by=10)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS) +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", color = "black") +
theme_bw() +
scale_fill_manual(values = finaldf$COLORS) +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity") +
theme_bw() +
scale_fill_manual(values = finaldf$COLORS, color = "black") +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_continuous(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_x_continuous(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_x_discrete(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_x_discrete(breaks=seq(100, 250, by=10), limits = c(100,250)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
coord_flip() +
xlab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS PER TEAM IN THE NHL \n(National Hockey League)"
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS PER TEAM IN THE NHL \n(National Hockey League)") +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
coord_flip()
install.packages('png')
install.packages('grid')
library(png)
library(grid)
img <- readPNG(system.file("img", "logo.png", package="png"))
getwd()
list.files()
img <- readPNG(system.file("img", "logo.png", package="png"))
library(png)
library(grid)
?system.file()
?readPNG
img <- readPNG("logo.png")
g <- rasterGrob(img, interpolate=TRUE)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(g, xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf) +
coord_flip()
flames_img <- readPNG("flames.png")
canucks_img <- readPNG("canucks.png")
install.packages("jpeg")
flames_img <- readPNG("flames.jpeg") #Calgary flames logo
canucks_img <- readPNG("canucks.jpeg") #Vancouver canucks logo
flames_img <- readPNG("flames.jpeg") #Calgary flames logo
canucks_img <- readPNG("canucks.jpeg") #Vancouver canucks logo
library(jpeg)
flames_img <- readPNG("flames.jpeg") #Calgary flames logo
canucks_img <- readPNG("canucks.jpeg") #Vancouver canucks logo
flames_img <- readjpeg("flames.jpeg") #Calgary flames logo
library(jpeg)
flames_img <- readJPEG("flames.jpeg") #Calgary flames logo
canucks_img <- readJPEG("canucks.jpeg") #Vancouver canucks logo
f <- rasterGrob(flames_img, interpolate=TRUE)
c <- rasterGrob(canucks_img, interpolate=TRUE)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=-Inf, xmax=Inf, ymin=TOTAL_GOALS + 5, ymax=Inf) +
annotation_custom(c, xmin=-Inf, xmax=Inf, ymin=TOTAL_GOALS + 5, ymax=Inf) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=-Inf, xmax=Inf, ymin=df$TOTAL_GOALS + 5, ymax=Inf) +
annotation_custom(c, xmin=-Inf, xmax=Inf, ymin=df$TOTAL_GOALS + 5, ymax=Inf) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)")
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=-Inf, xmax=Inf,
ymin=finaldf[which(finaldf$TEAM == "VAN"),2] + 5, ymax=Inf) +
annotation_custom(c, xmin=-Inf, xmax=Inf,
ymin=finaldf[which(finaldf$TEAM == "VAN"),2] + 5, ymax=Inf) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=-Inf, xmax=Inf,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf) +
annotation_custom(c, xmin=-Inf, xmax=Inf,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=0, xmax=Inf,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf) +
annotation_custom(c, xmin=0, xmax=Inf,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=0, xmax=0,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf) +
annotation_custom(c, xmin=0, xmax=0,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf) +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=0, xmax=0,
ymin=(finaldf[which(finaldf$TEAM == "VAN"),2]) + 5, ymax=Inf)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=-Inf, xmax=Inf,
ymin=-Inf, ymax=Inf)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAM IN THE NHL \n(National Hockey League)") +
annotation_custom(f, xmin=100, xmax=Inf,
ymin=-Inf, ymax=Inf)
library(ggplot2)
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 5,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAMS IN THE NHL \n(National Hockey League)") +
coord_flip()
ggsave(file="goals_graph.jpeg")
ggsave(ratings, file="ratings.pdf", scale=2)
ggsavefile="goals_barchart.jpeg", scale=2)
ggsave(file="goals_barchart.jpeg", scale=2)
finaldf[finaldf$TEAM == "CGY",3] <- "darkorange"
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 10,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAMS IN THE NHL \n(National Hockey League)") +
coord_flip()
finaldf <- df %>%
select(TEAM, GOALS = g1_number) %>%
group_by(TEAM) %>%
summarise(TOTAL_GOALS = sum(GOALS)) %>%
arrange(-TOTAL_GOALS)
finaldf$TEAM <- factor(finaldf$TEAM, as.character(-finaldf$TEAM))
finaldf <- df %>%
select(TEAM, GOALS = g1_number) %>%
group_by(TEAM) %>%
summarise(TOTAL_GOALS = sum(GOALS)) %>%
arrange(TOTAL_GOALS)
finaldf$TEAM <- factor(finaldf$TEAM, as.character(finaldf$TEAM))
finaldf$COLORS <- "ghostwhite"
finaldf[finaldf$TEAM == "VAN",3] <- "blue"
finaldf[finaldf$TEAM == "CGY",3] <- "darkorange"
finaldf$labels <- ""
finaldf[finaldf$TEAM == "VAN",4] <- finaldf[which(finaldf$TEAM == "VAN"),2] #2nd col is TOTAL_GOALS
finaldf[finaldf$TEAM == "CGY",4] <- finaldf[which(finaldf$TEAM == "CGY"),2] #2nd col is TOTAL_GOALS
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 10,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAMS IN THE NHL \n(National Hockey League)") +
coord_flip()
ggplot(aes(x=TEAM,y=TOTAL_GOALS), data=finaldf) +
geom_bar(stat="identity", fill = finaldf$COLORS, color = "black") +
theme_bw() +
geom_text(aes(x=TEAM,y=TOTAL_GOALS + 10,label=finaldf$labels),vjust=0) +
scale_y_discrete(breaks=seq(0, 250, by=10)) +
ylab("TOTAL GOALS AGAINST (2014-2015 REGULAR SEASON)") +
ggtitle("TOTAL GOALS SCORED BY TEAMS IN THE NHL \n(National Hockey League)") +
coord_flip()
ggsave(file="goals_barchart.jpeg", scale=2)
